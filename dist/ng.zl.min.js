angular.module("ng.zl",["ng","ngSanitize","ngMaterial","ng.zl.sha256","ng.zl.templates"]),angular.module("ng.zl.templates",[]).run(["$templateCache",function(t){t.put("views/grid.edit.html",'<div class="zl-grid-edit" ng-dblclick="onEdit($event)">\r\n    <span ng-bind="gridModel" ng-show="!edit"></span>\r\n    <input type="text" tabindex="-1" ng-model="gridModel" ng-show="edit" ng-blur="cancelEdit($event)" ng-keyup="onKey($event)" zl-focus-on="zlGridEditInput"/>\r\n</div>'),t.put("views/grid.edit.select.html",'<div class="zl-grid-edit" ng-dblclick="onEdit($event)">\r\n    <span ng-bind="gridModel" ng-show="!edit"></span>\r\n    <select tabindex="-1" ng-model="selected" ng-show="edit" zl-focus-on="zlGridEditSelect" ng-blur="cancelEdit($event)" ng-options="value.name for value in selects" ng-change="onChange($event)" ng-keyup="onKey($event)">\r\n    </select>\r\n</div>'),t.put("views/grid.edit.switch.html",'<div class="zl-grid-edit" ng-dblclick="onEdit($event)">\r\n    <span ng-bind="gridModel" ng-show="!edit"></span>\r\n\r\n    <md-switch class="md-primary" tabindex="-1" ng-model="gridModel" aria-label="Switch" zl-focus-on="zlGridEditSwitch" ng-show="edit" ng-blur="cancelEdit($event)" ng-keyup="onKey($event)" ng-change="onChange($event)"></md-switch>\r\n\r\n</div>'),t.put("views/grid.html",'<div class="zl-grid">\r\n    <table class="table table-striped table-hover table-condensed">\r\n        <thead>\r\n        <tr>\r\n            <th ng-if="config.enableSelect" class="zl-grid-select">\r\n                <md-checkbox ng-click="onCheckAll($event)"></md-checkbox>\r\n            </th>\r\n            <th ng-repeat="col in config.columns" ng-bind="col.name"></th>\r\n            <th ng-if="config.actions.length > 0">操作</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr ng-repeat="data in config.data">\r\n            <td ng-if="config.enableSelect" class="zl-grid-select">\r\n                <md-checkbox ng-model="data._checked"></md-checkbox>\r\n            </td>\r\n            <td ng-repeat="col in config.columns">\r\n                <span ng-if="!col.edit && col.render" style="{{col.style}}">\r\n                    <div zl-compile html="{{col.render(data[col.field])}}"></div>\r\n                </span>\r\n                <span ng-if="!col.edit && !col.render" ng-bind="data[col.field]" style="{{col.style}}"></span>\r\n\r\n                <div ng-if="col.edit && col.editType === \'input\'">\r\n                    <div zl-grid-edit grid-model="data[col.field]" grid-after-edit="onAfterEdit(value, col, data)"></div>\r\n                </div>\r\n                <div ng-if="col.edit && col.editType === \'select\'">\r\n                    <div zl-grid-edit-select grid-model="data[col.field]" grid-edit-type="col.editType" grid-edit-data="col.editData()" grid-after-edit="onAfterEdit(value, col, data)"></div>\r\n                </div>\r\n                <div ng-if="col.edit && col.editType === \'switch\'">\r\n                    <div zl-grid-edit-switch grid-model="data[col.field]" grid-after-edit="onAfterEdit(value, col, data)"></div>\r\n                </div>\r\n            </td>\r\n\r\n            <td ng-if="config.actions.length > 0">\r\n                <md-button ng-repeat="act in config.actions" class="md-raised {{act.className}}" ng-bind="act.html"\r\n                           ng-click="act.action(data, config.data, $event)"></md-button>\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n    <div layout="row">\r\n        <md-button class="md-raised" ng-click="getData()" ng-if="config.next">More</md-button>\r\n        <md-button class="md-raised" ng-if="!config.next" ng-disabled="true">No More</md-button>\r\n        <div flex ng-if="config.enableSelect && config.actions.length > 0">\r\n            <md-button ng-repeat="act in config.actions" class="md-raised {{act.className}}" ng-bind="act.html"\r\n                       ng-click="onBatch(act, $event)"></md-button>\r\n        </div>\r\n    </div>\r\n</div>'),t.put("views/progress.html",'<div class="zl-progress" ng-if="show">\r\n    <md-progress-circular md-mode="indeterminate"></md-progress-circular>\r\n</div>'),t.put("views/scroll.html",'<div class="zl-scroll">\r\n    <div ng-show="isShow">\r\n    <md-button class="md-fab md-primary md-mini" ng-click="onTop()" ng-if="top">\r\n        t\r\n    </md-button>\r\n\r\n    <md-button class="md-fab md-primary md-mini" ng-click="onBottom()" ng-if="bottom">\r\n        b\r\n    </md-button>\r\n    </div>\r\n</div>'),t.put("views/toast.html",'<div class="zl-toast-container">\r\n    <md-toast ng-repeat="t in list" class="md-default-theme">\r\n        <span ng-bind="t.word"></span>\r\n    </md-toast>\r\n</div>')}]),angular.module("ng.zl").directive("zlCompile",["$compile",function(t){"use strict";return{replace:!0,restrict:"A",link:function(n,e,i){if(i.html){var r=t(i.html)(n);e.replaceWith(r)}}}}]),angular.module("ng.zl").directive("zlDyCompile",["$compile",function(t){"use strict";return{replace:!0,restrict:"A",link:function(n,e,i){var r,o={$destroy:angular.noop},d=e,l=function(){(r||o).$destroy()};i.$observe("html",function(e){if(e){l(),r=n.$new(!0);var i=t(e)(n);d.replaceWith(i),d=i}n.$on("$destroy",l)})}}}]),angular.module("ng.zl").directive("zlFocusOn",function(){"use strict";return function(t,n,e){return t.$on("zlFocusOn",function(t,i){return i===e.zlFocusOn?n[0].focus():void 0})}}),angular.module("ng.zl.grid",["ng.zl"]).directive("zlGrid",["$zl",function(t){"use strict";return{restrict:"A",replace:!0,scope:{config:"="},templateUrl:"views/grid.html",controller:["$scope",function(n){_.each(n.config.columns,function(t){t.edit&&(t.afterEdit=t.afterEdit||function(){})}),n.config=_.extend({enableSelect:!1,columns:null,data:[],next:null,actions:[]},n.config),n.checkAll=!1,n.onCheckAll=function(){n.checkAll=!n.checkAll,_.each(n.config.data,function(t){t._checked=n.checkAll})},n.onBatch=function(t,e){var i=_.filter(n.config.data,function(t){return t._checked});i.length>0&&t.batch(i,n.config.data,e)},n.onAfterEdit=function(n,e,i){if(n.newValue!==n.oldValue){var r=e.afterEdit(i,e,n.newValue,n.oldValue);r&&r.then(function(){t.tips("修改成功")},function(){t.tips("修改失败"),i[e.field]=n.oldValue})}},n.onEditData=function(t){return t.editData()},n.getData=function(){n.config.getData(n.config.next).then(function(t){_.each(t,function(t,e){"pageOffset"!==e&&"pageAnchor"!==e&&(n.config.data=n.config.data.concat(t||[]))}),n.config.next=t.nextPageOffset||t.nextPageAnchor})},n.getData()}]}}]).directive("zlGridEdit",["$zlFocusOn","$timeout",function(t,n){"use strict";return{restrict:"A",replace:!0,scope:{gridModel:"=",gridAfterEdit:"&"},templateUrl:"views/grid.edit.html",controller:["$scope","$element",function(e,i){e.edit=!1;var r=e.gridModel;i.closest("td").width(i.width()),e.onEdit=function(n){i.addClass("zl-grid-edit-on"),e.edit=!0,t("zlGridEditInput")},e.cancelEdit=function(t){e.edit=!1},e.onKey=function(t){13===t.keyCode?(e.edit=!1,e.gridModel=t.target.value,n(function(){e.gridAfterEdit({value:{newValue:e.gridModel,oldValue:r}})},1)):27===t.keyCode&&(e.edit=!1,e.gridModel=r)}}]}}]).directive("zlGridEditSelect",["$zlFocusOn","$timeout",function(t,n){"use strict";return{restrict:"A",replace:!0,scope:{gridModel:"=",gridAfterEdit:"&",gridEditType:"@",gridEditData:"&"},templateUrl:"views/grid.edit.select.html",controller:["$scope","$element",function(e,i){e.edit=!1;var r=e.gridModel;e.selects=[],e.selected=null,e.gridEditData().then(function(t){e.selects=t,e.selected=_.find(t,function(t){return t.value===e.gridModel})}),i.closest("td").width(i.width()),e.onEdit=function(n){i.addClass("zl-grid-edit-on"),e.edit=!0,t("zlGridEditSelect")},e.cancelEdit=function(){e.edit=!1},e.onKey=function(){27===event.keyCode&&(e.edit=!1,e.gridModel=r)},e.onChange=function(t){e.edit=!1,e.gridModel=e.selected.value,n(function(){e.gridAfterEdit({value:{newValue:e.gridModel,oldValue:r}})},1)}}]}}]).directive("zlGridEditSwitch",["$zlFocusOn","$timeout",function(t,n){"use strict";return{restrict:"A",replace:!0,scope:{gridModel:"=",gridAfterEdit:"&"},templateUrl:"views/grid.edit.switch.html",controller:["$scope","$element",function(e,i){e.edit=!1,e.gridModel=e.gridModel||!1;var r=e.gridModel;i.closest("td").width(i.width()),e.onEdit=function(n){i.addClass("zl-grid-edit-on"),e.edit=!0,t("zlGridEditSwitch")},e.cancelEdit=function(t){e.edit=!1},e.onKey=function(t){27===t.keyCode&&(e.edit=!1,e.gridModel=r)},e.onChange=function(t){e.edit=!1,n(function(){e.gridAfterEdit({value:{newValue:e.gridModel,oldValue:r}})},1)}}]}}]),angular.module("ng.zl").directive("zlScroll",["$zl","$mdMedia",function(t,n){"use strict";return{restrict:"A",replace:!0,scope:{},templateUrl:"views/scroll.html",controller:["$scope","$element",function(e,i){var r=i.attr("zl-scroll");r.indexOf("scroll-top")>-1&&(e.top=!0),r.indexOf("scroll-bottom")>-1&&(e.bottom=!0),e.onTop=function(){t.scroll.top()},e.onBottom=function(){t.scroll.bottom()},e.isShow=n("gt-md")}]}}]),angular.module("ng.zl").factory("$zlFocusOn",["$rootScope","$timeout",function(t,n){"use strict";return function(e){return n(function(){return t.$broadcast("zlFocusOn",e)})}}]),angular.module("ng.zl").factory("$zl",["$mdDialog","$mdToast","$compile","$rootScope","$templateRequest","$timeout","$zlSha256","$q",function(t,n,e,i,r,o,d,l){"use strict";var c=$(document.body),a=function(n,e,i){var r=t.alert().parent(c).title(e).content(n).ok("ok");return i&&(r=r.targetEvent(i)),t.show(r)},s=function(n,e,i,r,o){r=r||"ok",o=o||"cancel";var d=t.confirm().parent(c).title(e).content(n).ok(r).cancel(o);return i&&(d=d.targetEvent(i)),t.show(d)},u=null,g=i.$new();g.list=[];var f=function(t,n,i){var d=l.defer();u||(u=!0,r("views/toast.html").then(function(t){u=$(t),$(document.body).append(u),e(u)(g)}));var c=+new Date;return g.list.unshift({word:t,_key_:c}),o(function(){g.list.splice(g.list.indexOf(_.find(g.list,function(t){return t._key_===c})),1),d.resolve({})},i||4e3),d.promise},m=null,v=i.$new();v.show=!1;var h={start:function(){m||(m=!0,r("views/progress.html").then(function(t){m=$(t),$(document.body).append(m),e(m)(v)})),v.show=!0},done:function(){v.show=!1}},p={set:function(t){var n=$(".site-content")[0];n.scrollTop=t},top:function(){p.set(0)},bottom:function(){p.set($(document.body).height())},page:function(){p.set(document.body.scrollTop+document.documentElement.clientHeight)}},w=function(t,n){var e=t;return arguments.length<2?e:e=e.replace(/\{([\d\w\.]+)\}/g,function(t){var e=arguments[1].split("."),i=null;return _.each(e,function(t,e){i=e?i[t]:n[t]}),i})},b=null,z={set:function(t){b=t},get:function(){return b}},y={alert:a,confirm:s,tips:f,progress:h,scroll:p,format:w,sha256:d,userInfo:z};return window.ZL=y,y}]),angular.module("ng.zl.sha256",[]).factory("$zlSha256",function(){"use strict";var t=function(t){function n(t,n){return n>>>t|n<<32-t}function e(t,n,e){return t&n^~t&e}function i(t,n,e){return t&n^t&e^n&e}function r(t){return n(2,t)^n(13,t)^n(22,t)}function o(t){return n(6,t)^n(11,t)^n(25,t)}function d(t){return n(7,t)^n(18,t)^t>>>3}function l(t){return n(17,t)^n(19,t)^t>>>10}function c(t,n){return t[15&n]+=l(t[n+14&15])+t[n+9&15]+d(t[n+1&15])}function a(t,n){var e=(65535&t)+(65535&n),i=(t>>16)+(n>>16)+(e>>16);return i<<16|65535&e}function s(){h=new Array(8),p=new Array(2),w=new Array(64),p[0]=p[1]=0,h[0]=1779033703,h[1]=3144134277,h[2]=1013904242,h[3]=2773480762,h[4]=1359893119,h[5]=2600822924,h[6]=528734635,h[7]=1541459225}function u(){var t,n,d,l,s,u,g,f,m,v,p=new Array(16);t=h[0],n=h[1],d=h[2],l=h[3],s=h[4],u=h[5],g=h[6],f=h[7];for(var b=0;16>b;b++)p[b]=w[(b<<2)+3]|w[(b<<2)+2]<<8|w[(b<<2)+1]<<16|w[b<<2]<<24;for(var z=0;64>z;z++)m=f+o(s)+e(s,u,g)+$[z],m+=16>z?p[z]:c(p,z),v=r(t)+i(t,n,d),f=g,g=u,u=s,s=a(l,m),l=d,d=n,n=t,t=a(m,v);h[0]+=t,h[1]+=n,h[2]+=d,h[3]+=l,h[4]+=s,h[5]+=u,h[6]+=g,h[7]+=f}function g(t,n){var e,i,r=0;i=p[0]>>3&63;var o=63&n;for((p[0]+=n<<3)<n<<3&&p[1]++,p[1]+=n>>29,e=0;n>e+63;e+=64){for(var d=i;64>d;d++)w[d]=t.charCodeAt(r++);u(),i=0}for(var d=0;o>d;d++)w[d]=t.charCodeAt(r++)}function f(){var t=p[0]>>3&63;if(w[t++]=128,56>=t)for(var n=t;56>n;n++)w[n]=0;else{for(var n=t;64>n;n++)w[n]=0;u();for(var n=0;56>n;n++)w[n]=0}w[56]=p[1]>>>24&255,w[57]=p[1]>>>16&255,w[58]=p[1]>>>8&255,w[59]=255&p[1],w[60]=p[0]>>>24&255,w[61]=p[0]>>>16&255,w[62]=p[0]>>>8&255,w[63]=255&p[0],u()}function m(){for(var t=new String,n=0;8>n;n++)for(var e=28;e>=0;e-=4)t+=b.charAt(h[n]>>>e&15);return t}function v(t){return s(),g(t,t.length),f(),m()}var h,p,w,$=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),b="0123456789abcdef";return v(t)};return t});