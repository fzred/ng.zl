angular.module("ng.zl",["ng","ngMaterial","ng.zl.sha256","ng.zl.templates"]),angular.module("ng.zl.templates",[]).run(["$templateCache",function(n){n.put("views/grid.edit.html",'<div class="zl-grid-edit" ng-dblclick="onEdit($event)">\r\n    <span ng-bind="gridModel" ng-show="!edit"></span>\r\n    <input type="text" tabindex="-1" ng-model="gridModel" ng-show="edit" ng-blur="cancelEdit()" ng-keyup="onEnter($event)" zl-focus-on="zlGridEditInput"/>\r\n</div>'),n.put("views/grid.html",'<div class="zl-grid">\r\n    <table class="table table-striped table-hover table-condensed">\r\n        <thead>\r\n        <tr>\r\n            <th ng-if="config.enableSelect" class="zl-grid-select">\r\n                <md-checkbox ng-click="onCheckAll($event)"></md-checkbox>\r\n            </th>\r\n            <th ng-repeat="col in config.columns" ng-bind="col.name"></th>\r\n            <th ng-if="config.actions.length > 0">操作</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr ng-repeat="data in config.data">\r\n            <td ng-if="config.enableSelect" class="zl-grid-select">\r\n                <md-checkbox ng-model="data._checked"></md-checkbox>\r\n            </td>\r\n            <td ng-repeat="col in config.columns">\r\n                <span ng-if="!col.edit" ng-bind="data[col.field]" style="{{col.style}}"></span>\r\n                <div ng-if="col.edit">\r\n                    <div zl-grid-edit grid-model="data[col.field]" grid-after-edit="onAfterEdit(value, col, data)"></div>\r\n                </div>\r\n            </td>\r\n\r\n            <td ng-if="config.actions.length > 0">\r\n                <md-button ng-repeat="act in config.actions" class="md-raised {{act.className}}" ng-bind="act.html"\r\n                           ng-click="act.action(data, config.data, $event)"></md-button>\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n    <div layout="row">\r\n        <md-button class="md-raised" ng-click="getData()" ng-if="config.next">More</md-button>\r\n        <md-button class="md-raised" ng-if="!config.next" ng-disabled="true">No More</md-button>\r\n        <div flex ng-if="config.enableSelect && config.actions.length > 0">\r\n            <md-button ng-repeat="act in config.actions" class="md-raised {{act.className}}" ng-bind="act.html"\r\n                       ng-click="onBatch(act, $event)"></md-button>\r\n        </div>\r\n    </div>\r\n</div>'),n.put("views/progress.html",'<div class="zl-progress" ng-if="show">\r\n    <md-progress-circular md-mode="indeterminate"></md-progress-circular>\r\n</div>'),n.put("views/toast.html",'<div class="zl-toast-container">\r\n    <md-toast ng-repeat="t in list" class="md-default-theme">\r\n        <span ng-bind="t.word"></span>\r\n    </md-toast>\r\n</div>')}]),angular.module("ng.zl").directive("zlFocusOn",function(){"use strict";return function(n,t,e){return n.$on("zlFocusOn",function(n,r){return r===e.zlFocusOn?t[0].focus():void 0})}}),angular.module("ng.zl.grid",["ng.zl"]).directive("zlGrid",["$zl",function(n){"use strict";return{restrict:"A",replace:!0,scope:{config:"="},templateUrl:"views/grid.html",controller:["$scope",function(t){_.each(t.config.columns,function(n){n.edit&&(n.afterEdit=n.afterEdit||function(){})}),t.config=_.extend({enableSelect:!1,columns:null,data:[],next:null,actions:[]},t.config),t.checkAll=!1,t.onCheckAll=function(){t.checkAll=!t.checkAll,_.each(t.config.data,function(n){n._checked=t.checkAll})},t.onBatch=function(n,e){var r=_.filter(t.config.data,function(n){return n._checked});r.length>0&&n.batch(r,t.config.data,e)},t.onAfterEdit=function(t,e,r){if(t.newValue!==t.oldValue){var o=e.afterEdit(r,e,t.newValue,t.oldValue);o&&o.then(function(){n.tips("修改成功")},function(){n.tips("修改失败"),r[e.field]=t.oldValue})}},t.getData=function(){t.config.getData(t.config.next).then(function(n){_.each(n,function(n,e){"pageOffset"!==e&&"pageAnchor"!==e&&(t.config.data=t.config.data.concat(n||[]))}),t.config.next=n.nextPageOffset||n.nextPageAnchor})},t.getData()}]}}]).directive("zlGridEdit",["$zlFocusOn",function(n){"use strict";return{restrict:"A",replace:!0,scope:{gridModel:"=",gridAfterEdit:"&"},templateUrl:"views/grid.edit.html",controller:["$scope","$element",function(t,e){t.edit=!1;var r=t.gridModel;e.closest("td").width(e.width()),t.onEdit=function(r){e.addClass("zl-grid-edit-on"),t.edit=!0,n("zlGridEditInput")},t.cancelEdit=function(){t.edit=!1,t.gridModel=r},t.onEnter=function(n){13===n.keyCode?(t.edit=!1,t.gridAfterEdit({value:{newValue:t.gridModel,oldValue:r}})):27===n.keyCode&&(t.edit=!1,t.gridModel=r)}}]}}]),angular.module("ng.zl").factory("$zlFocusOn",["$rootScope","$timeout",function(n,t){"use strict";return function(e){return t(function(){return n.$broadcast("zlFocusOn",e)})}}]),angular.module("ng.zl").factory("$zl",["$mdDialog","$mdToast","$compile","$rootScope","$templateRequest","$timeout","$zlSha256","$q",function(n,t,e,r,o,i,c,a){"use strict";var l=$(document.body),d=function(t,e,r){var o=n.alert().parent(l).title(e).content(t).ok("ok");return r&&(o=o.targetEvent(r)),n.show(o)},u=function(t,e,r,o,i){o=o||"ok",i=i||"cancel";var c=n.confirm().parent(l).title(e).content(t).ok(o).cancel(i);return r&&(c=c.targetEvent(r)),n.show(c)},s=null,f=r.$new();f.list=[];var g=function(n,t,r){var c=a.defer();s||(s=!0,o("views/toast.html").then(function(n){s=$(n),$(document.body).append(s),e(s)(f)}));var l=+new Date;return f.list.unshift({word:n,_key_:l}),i(function(){f.list.splice(f.list.indexOf(_.find(f.list,function(n){return n._key_===l})),1),c.resolve({})},r||4e3),c.promise},m=null,h=r.$new();h.show=!1;var v={start:function(){m||(m=!0,o("views/progress.html").then(function(n){m=$(n),$(document.body).append(m),e(m)(h)})),h.show=!0},done:function(){h.show=!1}},p={set:function(n){var t=$(".site-content")[0];t.scrollTop=n},top:function(){p.set(0)},bottom:function(){p.set($(document.body).height())},page:function(){p.set(document.body.scrollTop+document.documentElement.clientHeight)}},b=function(n,t){var e=n;return arguments.length<2?e:e=e.replace(/\{([\d\w\.]+)\}/g,function(n){var e=arguments[1].split("."),r=null;return _.each(e,function(n,e){r=e?r[n]:t[n]}),r})},w=null,z={set:function(n){w=n},get:function(){return w}},k={alert:d,confirm:u,tips:g,progress:v,scroll:p,format:b,sha256:c,userInfo:z};return window.ZL=k,k}]),angular.module("ng.zl.sha256",[]).factory("$zlSha256",function(){"use strict";var n=function(n){function t(n,t){return t>>>n|t<<32-n}function e(n,t,e){return n&t^~n&e}function r(n,t,e){return n&t^n&e^t&e}function o(n){return t(2,n)^t(13,n)^t(22,n)}function i(n){return t(6,n)^t(11,n)^t(25,n)}function c(n){return t(7,n)^t(18,n)^n>>>3}function a(n){return t(17,n)^t(19,n)^n>>>10}function l(n,t){return n[15&t]+=a(n[t+14&15])+n[t+9&15]+c(n[t+1&15])}function d(n,t){var e=(65535&n)+(65535&t),r=(n>>16)+(t>>16)+(e>>16);return r<<16|65535&e}function u(){v=new Array(8),p=new Array(2),b=new Array(64),p[0]=p[1]=0,v[0]=1779033703,v[1]=3144134277,v[2]=1013904242,v[3]=2773480762,v[4]=1359893119,v[5]=2600822924,v[6]=528734635,v[7]=1541459225}function s(){var n,t,c,a,u,s,f,g,m,h,p=new Array(16);n=v[0],t=v[1],c=v[2],a=v[3],u=v[4],s=v[5],f=v[6],g=v[7];for(var $=0;16>$;$++)p[$]=b[($<<2)+3]|b[($<<2)+2]<<8|b[($<<2)+1]<<16|b[$<<2]<<24;for(var z=0;64>z;z++)m=g+i(u)+e(u,s,f)+w[z],m+=16>z?p[z]:l(p,z),h=o(n)+r(n,t,c),g=f,f=s,s=u,u=d(a,m),a=c,c=t,t=n,n=d(m,h);v[0]+=n,v[1]+=t,v[2]+=c,v[3]+=a,v[4]+=u,v[5]+=s,v[6]+=f,v[7]+=g}function f(n,t){var e,r,o=0;r=p[0]>>3&63;var i=63&t;for((p[0]+=t<<3)<t<<3&&p[1]++,p[1]+=t>>29,e=0;t>e+63;e+=64){for(var c=r;64>c;c++)b[c]=n.charCodeAt(o++);s(),r=0}for(var c=0;i>c;c++)b[c]=n.charCodeAt(o++)}function g(){var n=p[0]>>3&63;if(b[n++]=128,56>=n)for(var t=n;56>t;t++)b[t]=0;else{for(var t=n;64>t;t++)b[t]=0;s();for(var t=0;56>t;t++)b[t]=0}b[56]=p[1]>>>24&255,b[57]=p[1]>>>16&255,b[58]=p[1]>>>8&255,b[59]=255&p[1],b[60]=p[0]>>>24&255,b[61]=p[0]>>>16&255,b[62]=p[0]>>>8&255,b[63]=255&p[0],s()}function m(){for(var n=new String,t=0;8>t;t++)for(var e=28;e>=0;e-=4)n+=$.charAt(v[t]>>>e&15);return n}function h(n){return u(),f(n,n.length),g(),m()}var v,p,b,w=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),$="0123456789abcdef";return h(n)};return n});