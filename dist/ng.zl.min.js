angular.module("ng.zl",["ng","ngSanitize","ngMaterial","ng.zl.sha256","ng.zl.templates"]),angular.module("ng.zl.templates",[]).run(["$templateCache",function(t){t.put("views/grid.edit.html",'<div class="zl-grid-edit" ng-dblclick="onEdit($event)">\r\n    <span ng-bind="gridModel" ng-show="!edit"></span>\r\n    <input type="text" tabindex="-1" ng-model="gridModel" ng-show="edit" ng-blur="cancelEdit($event)" ng-keyup="onEnter($event)" zl-focus-on="zlGridEditInput"/>\r\n</div>'),t.put("views/grid.edit.select.html",'<div class="zl-grid-edit" ng-dblclick="onEdit($event)">\r\n    <span ng-bind="gridModel" ng-show="!edit"></span>\r\n    <select tabindex="-1" ng-model="selected" ng-show="edit" ng-blur="cancelEdit($event)" ng-options="value.name for value in selects" ng-change="onChange($event)">\r\n    </select>\r\n</div>'),t.put("views/grid.html",'<div class="zl-grid">\r\n    <table class="table table-striped table-hover table-condensed">\r\n        <thead>\r\n        <tr>\r\n            <th ng-if="config.enableSelect" class="zl-grid-select">\r\n                <md-checkbox ng-click="onCheckAll($event)"></md-checkbox>\r\n            </th>\r\n            <th ng-repeat="col in config.columns" ng-bind="col.name"></th>\r\n            <th ng-if="config.actions.length > 0">操作</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr ng-repeat="data in config.data">\r\n            <td ng-if="config.enableSelect" class="zl-grid-select">\r\n                <md-checkbox ng-model="data._checked"></md-checkbox>\r\n            </td>\r\n            <td ng-repeat="col in config.columns">\r\n                <span ng-if="!col.edit && col.render" ng-bind-html="col.render(data[col.field])" style="{{col.style}}"></span>\r\n                <span ng-if="!col.edit && !col.render" ng-bind="data[col.field]" style="{{col.style}}"></span>\r\n\r\n                <div ng-if="col.edit && col.editType === \'input\'">\r\n                    <div zl-grid-edit grid-model="data[col.field]" grid-after-edit="onAfterEdit(value, col, data)"></div>\r\n                </div>\r\n                <div ng-if="col.edit && col.editType === \'select\'">\r\n                    <div zl-grid-edit-select grid-model="data[col.field]" grid-edit-type="col.editType" grid-edit-data="col.editData()" grid-after-edit="onAfterEdit(value, col, data)"></div>\r\n                </div>\r\n            </td>\r\n\r\n            <td ng-if="config.actions.length > 0">\r\n                <md-button ng-repeat="act in config.actions" class="md-raised {{act.className}}" ng-bind="act.html"\r\n                           ng-click="act.action(data, config.data, $event)"></md-button>\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n    <div layout="row">\r\n        <md-button class="md-raised" ng-click="getData()" ng-if="config.next">More</md-button>\r\n        <md-button class="md-raised" ng-if="!config.next" ng-disabled="true">No More</md-button>\r\n        <div flex ng-if="config.enableSelect && config.actions.length > 0">\r\n            <md-button ng-repeat="act in config.actions" class="md-raised {{act.className}}" ng-bind="act.html"\r\n                       ng-click="onBatch(act, $event)"></md-button>\r\n        </div>\r\n    </div>\r\n</div>'),t.put("views/progress.html",'<div class="zl-progress" ng-if="show">\r\n    <md-progress-circular md-mode="indeterminate"></md-progress-circular>\r\n</div>'),t.put("views/scroll.html",'<div class="zl-scroll">\r\n    <div ng-show="isShow">\r\n    <md-button class="md-fab md-primary md-mini" ng-click="onTop()" ng-if="top">\r\n        t\r\n    </md-button>\r\n\r\n    <md-button class="md-fab md-primary md-mini" ng-click="onBottom()" ng-if="bottom">\r\n        b\r\n    </md-button>\r\n    </div>\r\n</div>'),t.put("views/toast.html",'<div class="zl-toast-container">\r\n    <md-toast ng-repeat="t in list" class="md-default-theme">\r\n        <span ng-bind="t.word"></span>\r\n    </md-toast>\r\n</div>')}]),angular.module("ng.zl").directive("zlFocusOn",function(){"use strict";return function(t,n,e){return t.$on("zlFocusOn",function(t,i){return i===e.zlFocusOn?n[0].focus():void 0})}}),angular.module("ng.zl.grid",["ng.zl"]).directive("zlGrid",["$zl",function(t){"use strict";return{restrict:"A",replace:!0,scope:{config:"="},templateUrl:"views/grid.html",controller:["$scope",function(n){_.each(n.config.columns,function(t){t.edit&&(t.afterEdit=t.afterEdit||function(){})}),n.config=_.extend({enableSelect:!1,columns:null,data:[],next:null,actions:[]},n.config),n.checkAll=!1,n.onCheckAll=function(){n.checkAll=!n.checkAll,_.each(n.config.data,function(t){t._checked=n.checkAll})},n.onBatch=function(t,e){var i=_.filter(n.config.data,function(t){return t._checked});i.length>0&&t.batch(i,n.config.data,e)},n.onAfterEdit=function(n,e,i){if(n.newValue!==n.oldValue){var r=e.afterEdit(i,e,n.newValue,n.oldValue);r&&r.then(function(){t.tips("修改成功")},function(){t.tips("修改失败"),i[e.field]=n.oldValue})}},n.onEditData=function(t){return t.editData()},n.getData=function(){n.config.getData(n.config.next).then(function(t){_.each(t,function(t,e){"pageOffset"!==e&&"pageAnchor"!==e&&(n.config.data=n.config.data.concat(t||[]))}),n.config.next=t.nextPageOffset||t.nextPageAnchor})},n.getData()}]}}]).directive("zlGridEdit",["$zlFocusOn","$timeout",function(t,n){"use strict";return{restrict:"A",replace:!0,scope:{gridModel:"=",gridAfterEdit:"&"},templateUrl:"views/grid.edit.html",controller:["$scope","$element",function(e,i){e.edit=!1;var r=e.gridModel;i.closest("td").width(i.width()),e.onEdit=function(n){i.addClass("zl-grid-edit-on"),e.edit=!0,t("zlGridEditInput")},e.cancelEdit=function(t){e.edit=!1},e.onEnter=function(t){13===t.keyCode?(e.edit=!1,e.gridModel=t.target.value,n(function(){e.gridAfterEdit({value:{newValue:e.gridModel,oldValue:r}})},1)):27===t.keyCode&&(e.edit=!1,e.gridModel=r)}}]}}]).directive("zlGridEditSelect",["$zlFocusOn","$timeout",function(t,n){"use strict";return{restrict:"A",replace:!0,scope:{gridModel:"=",gridAfterEdit:"&",gridEditType:"@",gridEditData:"&"},templateUrl:"views/grid.edit.select.html",controller:["$scope","$element",function(e,i){e.edit=!1;var r=e.gridModel;e.selects=[],e.selected=null,e.gridEditData().then(function(t){e.selects=t,e.selected=_.find(t,function(t){return t.value===e.gridModel})}),i.closest("td").width(i.width()),e.onEdit=function(n){i.addClass("zl-grid-edit-on"),e.edit=!0,t("zlGridEditInput")},e.cancelEdit=function(){},e.onChange=function(t){e.edit=!1,e.gridModel=e.selected.value,n(function(){e.gridAfterEdit({value:{newValue:e.gridModel,oldValue:r}})},1)}}]}}]),angular.module("ng.zl").directive("zlScroll",["$zl","$mdMedia",function(t,n){"use strict";return{restrict:"A",replace:!0,scope:{},templateUrl:"views/scroll.html",controller:["$scope","$element",function(e,i){var r=i.attr("scroll-directive");r.indexOf("scroll-top")>-1&&(e.top=!0),r.indexOf("scroll-bottom")>-1&&(e.bottom=!0),e.onTop=function(){t.scroll.top()},e.onBottom=function(){t.scroll.bottom()},e.isShow=n("gt-md")}]}}]),angular.module("ng.zl").factory("$zlFocusOn",["$rootScope","$timeout",function(t,n){"use strict";return function(e){return n(function(){return t.$broadcast("zlFocusOn",e)})}}]),angular.module("ng.zl").factory("$zl",["$mdDialog","$mdToast","$compile","$rootScope","$templateRequest","$timeout","$zlSha256","$q",function(t,n,e,i,r,o,c,l){"use strict";var d=$(document.body),a=function(n,e,i){var r=t.alert().parent(d).title(e).content(n).ok("ok");return i&&(r=r.targetEvent(i)),t.show(r)},u=function(n,e,i,r,o){r=r||"ok",o=o||"cancel";var c=t.confirm().parent(d).title(e).content(n).ok(r).cancel(o);return i&&(c=c.targetEvent(i)),t.show(c)},s=null,g=i.$new();g.list=[];var f=function(t,n,i){var c=l.defer();s||(s=!0,r("views/toast.html").then(function(t){s=$(t),$(document.body).append(s),e(s)(g)}));var d=+new Date;return g.list.unshift({word:t,_key_:d}),o(function(){g.list.splice(g.list.indexOf(_.find(g.list,function(t){return t._key_===d})),1),c.resolve({})},i||4e3),c.promise},m=null,v=i.$new();v.show=!1;var p={start:function(){m||(m=!0,r("views/progress.html").then(function(t){m=$(t),$(document.body).append(m),e(m)(v)})),v.show=!0},done:function(){v.show=!1}},h={set:function(t){var n=$(".site-content")[0];n.scrollTop=t},top:function(){h.set(0)},bottom:function(){h.set($(document.body).height())},page:function(){h.set(document.body.scrollTop+document.documentElement.clientHeight)}},b=function(t,n){var e=t;return arguments.length<2?e:e=e.replace(/\{([\d\w\.]+)\}/g,function(t){var e=arguments[1].split("."),i=null;return _.each(e,function(t,e){i=e?i[t]:n[t]}),i})},w=null,z={set:function(t){w=t},get:function(){return w}},y={alert:a,confirm:u,tips:f,progress:p,scroll:h,format:b,sha256:c,userInfo:z};return window.ZL=y,y}]),angular.module("ng.zl.sha256",[]).factory("$zlSha256",function(){"use strict";var t=function(t){function n(t,n){return n>>>t|n<<32-t}function e(t,n,e){return t&n^~t&e}function i(t,n,e){return t&n^t&e^n&e}function r(t){return n(2,t)^n(13,t)^n(22,t)}function o(t){return n(6,t)^n(11,t)^n(25,t)}function c(t){return n(7,t)^n(18,t)^t>>>3}function l(t){return n(17,t)^n(19,t)^t>>>10}function d(t,n){return t[15&n]+=l(t[n+14&15])+t[n+9&15]+c(t[n+1&15])}function a(t,n){var e=(65535&t)+(65535&n),i=(t>>16)+(n>>16)+(e>>16);return i<<16|65535&e}function u(){p=new Array(8),h=new Array(2),b=new Array(64),h[0]=h[1]=0,p[0]=1779033703,p[1]=3144134277,p[2]=1013904242,p[3]=2773480762,p[4]=1359893119,p[5]=2600822924,p[6]=528734635,p[7]=1541459225}function s(){var t,n,c,l,u,s,g,f,m,v,h=new Array(16);t=p[0],n=p[1],c=p[2],l=p[3],u=p[4],s=p[5],g=p[6],f=p[7];for(var $=0;16>$;$++)h[$]=b[($<<2)+3]|b[($<<2)+2]<<8|b[($<<2)+1]<<16|b[$<<2]<<24;for(var z=0;64>z;z++)m=f+o(u)+e(u,s,g)+w[z],m+=16>z?h[z]:d(h,z),v=r(t)+i(t,n,c),f=g,g=s,s=u,u=a(l,m),l=c,c=n,n=t,t=a(m,v);p[0]+=t,p[1]+=n,p[2]+=c,p[3]+=l,p[4]+=u,p[5]+=s,p[6]+=g,p[7]+=f}function g(t,n){var e,i,r=0;i=h[0]>>3&63;var o=63&n;for((h[0]+=n<<3)<n<<3&&h[1]++,h[1]+=n>>29,e=0;n>e+63;e+=64){for(var c=i;64>c;c++)b[c]=t.charCodeAt(r++);s(),i=0}for(var c=0;o>c;c++)b[c]=t.charCodeAt(r++)}function f(){var t=h[0]>>3&63;if(b[t++]=128,56>=t)for(var n=t;56>n;n++)b[n]=0;else{for(var n=t;64>n;n++)b[n]=0;s();for(var n=0;56>n;n++)b[n]=0}b[56]=h[1]>>>24&255,b[57]=h[1]>>>16&255,b[58]=h[1]>>>8&255,b[59]=255&h[1],b[60]=h[0]>>>24&255,b[61]=h[0]>>>16&255,b[62]=h[0]>>>8&255,b[63]=255&h[0],s()}function m(){for(var t=new String,n=0;8>n;n++)for(var e=28;e>=0;e-=4)t+=$.charAt(p[n]>>>e&15);return t}function v(t){return u(),g(t,t.length),f(),m()}var p,h,b,w=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),$="0123456789abcdef";return v(t)};return t});